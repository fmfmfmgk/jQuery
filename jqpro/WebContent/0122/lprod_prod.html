<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="../css/public.css">
<script src="../js/jquery-3.7.1.min.js"></script>
<script type="text/javascript">
$(function(){
	
	//lprod의 제품이 선택되면 
	$('#lprod').on('change',function(){
		//lprod(부모)에서 선택한 항목의 option(자식) value값을 가져온다.
		//alert($('#lprod option:selected').val());
	
		guvalue = $('option:selected',this).val().trim();
		console.log(guvalue);
		//서버로 전송
		$.ajax({
			url  : '/jqpro/0122/prodLguServlet.jsp',
			type : 'get',
			data : 'gu='+guvalue,
			success : function(res){
				code = "";
				if(res.flag == "ok"){
					$.each(res.datas,function(i,v){
						code += `<option value="${v.prodId}">${v.prodName}</option>`
					})
				}else{
					code += `<option value="0">데이터없음</option>`
				}
				$('#prod').html(code);
			},
			error : function(xhr){
				alert("상태 : " + xhr.status);
			},
			dataType : 'json'
		})
	})
	
	//lprod가 출력
	$('#btn1').on('click',function(){
		$.ajax({
			url : '/jqpro/0119/LprodServlet.jsp',
			type : 'get',
			success : function(res){
				code = "";
				$.each(res,function(i,v){
					code += `<option value="${v.lprod_gu}">${v.lprod_nm}</option>`
				})
				
				$('#lprod').html(code); //누를때마다 초기화
				//$('#lprod').append(code); //누를때마다 추가
				
				
				/* code = "<table border='1'";
				code += "<tr><td>상품번호</td>";
				code += "<td>분류번호</td>";
				code += "<td>분류명</td></tr>";
				
				$.each(res,function(i, v){
					code += `<tr><td>${v.lprod_id}</td>`;
					code += `<td>${v.lprod_gu}</td>`;
					code += `<td>${v.lprod_nm}</td></tr>`;
				})
				code += "</table>";
				
				$('#result1').html(code);
				
				 */
			},
			error : function(xhr){
				alert("상태 : " + xhr.status);
			},
			dataType : 'json'
		})
	})
})
</script>
</head>
<body>

<div class="box">
<h4></h4>
<input type="button" value="확인" id="btn1">
<br><br>
<select id="lprod">
</select>
<select id="prod">
</select>
<div id="result1"></div>
</div>



</body>
</html>









